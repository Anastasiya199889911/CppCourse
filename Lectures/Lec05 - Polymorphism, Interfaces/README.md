# Лекция 5 - Полиморфизм, интерфейсы

**Одна из важнейших лекций курса**

План:

* Полиморфизм в широком смысле:
    - перегрузка функций
    - перегрузка операторов
    - полиморфизм подтипа
    - шаблоны
* Полиморфизм как принцип ООП (полиморфизм подтипа)
* Раннее и позднее связывание, таблицы виртуальных функций
* Виртуальный деструктор
* Виртуальный конструктор (такая штука вообще есть?)
* Полиморфизм и закрытое наследование (*C++ only*)
* Абстрактные классы, чисто виртуальные методы
* Пример вложенного (nested-) класса
* Интерфейсы: технические и философские аспекты


Последний пункт можно вполне считать центральным в объектно-ориентированном проектировании и программировании.


### Полиморфизм на примере классов Employee, Operator, Driver

Сначала проведен технический осмотр механизма полиморфизма. Подробности - см. в функции ```main()```.

![objects](https://github.com/ar1st0crat/CppCourse/blob/master/Lectures/Lec05%20-%20Polymorphism,%20Interfaces/objects.png)


### Абстрактный класс GeoService и его реализация TaxiGeoService

Далее в проект был введен класс гео-службы GeoService.

В нем есть как конкретика (координаты центра города, методы для расчета расстояний между объектами и преобразования адресов в геокоординаты и обратно), так и сугубо абстрактная "вещь" - составление маршрута от адреса к адресу, а также оценка времени доставки клиента к месту назначения (это только идея для гео-службы, идея, которую выражают уже конкретные реализации гео-службы).

В случае с абстракциями можно говорить, что класс уже не просто наследуется от другого класса (наследование реализации), а реализует его "интерфейс" (наследование интерфейса, реализация интерфейса).

Класс **Гео-служба такси** не просто *является* гео-службой (is-a), а еще конкретным образом реализует *идею* составления маршрута от адреса к адресу, а также оценки времени доставки клиента к месту назначения.


### Интерфейс IPrintable

Если абстрактный класс вообще не имеет никакой конкретики, а служит только как выражение намерений программиста, то он называется **интерфейсом** (к сожалению, в С++ не выделено отдельное ключевое слово для такой важной концепции). В нашем проекте выделим пока один простейший интерфейс IPrintable - этот интерфейс задает функционал отображения объекта.

![is_a](https://github.com/ar1st0crat/CppCourse/blob/master/Lectures/Lec05%20-%20Polymorphism,%20Interfaces/is_a.png)

*Интерфейс - это просто абстрактный класс, доведенный до фанатизма?*

Интерфейс - это только технически класс, а концептуально - это способ программисту закодировать не сущность, а некоторую идею и свои намерения. Если угодно, по интерфейсам в проекте может (по крайней мере, должно) стать понятно, как эта система задумывалась работать хотя бы на уровне взаимодействия отдельных объектов.

*Пишут ли люди вообще пустые интерфейсы?*

Да. Хотя технически это ничего не дает (кроме оверхеда в 4/8 байт на размер объектов всех классов, реализующих данный пустой интерфейс), такие интерфейсы могут значительно облегчить понимание тех или иных конкретных классов (один из элементов самодокументирования кода).


### Все классы, игравшие в этой лекции:

![uml](https://github.com/ar1st0crat/CppCourse/blob/master/Lectures/Lec05%20-%20Polymorphism,%20Interfaces/uml.png)
